<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>â˜ï¸ Sayyamâ€™s Smart Weather</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>
  <div class="mode-toggle">
    <input type="checkbox" id="themeSwitch">
    <label for="themeSwitch" class="switch"></label>
  </div>

  <div class="main">
    <h1 class="title">ğŸŒ¦ï¸ Sayyamâ€™s Smart Weather Dashboard</h1>
    <div id="clock"></div>

    <form action="/" method="post" class="search-bar">
      <input list="cities" id="cityInput" name="city" placeholder="ğŸ” Enter city..." required autocomplete="off">
      <datalist id="cities">
        <option value="New York"><option value="London"><option value="Paris">
        <option value="Tokyo"><option value="Mumbai"><option value="Dubai">
        <option value="Sydney"><option value="Toronto"><option value="Berlin">
      </datalist>
      <button type="submit">Search</button>
      <button type="button" id="micBtn">ğŸ¤</button>
    </form>

    {% if weather %}
    <div class="card">
      <h2>{{ weather['name'] }}</h2>
      <img src="https://openweathermap.org/img/wn/{{ weather['weather'][0]['icon'] }}@2x.png" class="icon">
      <p class="temp">{{ weather['main']['temp'] }}Â°C</p>
      <p class="condition">{{ weather['weather'][0]['description'].title() }}</p>
      <div class="details">
        <p>ğŸ’§ Humidity: {{ weather['main']['humidity'] }}%</p>
        <p>ğŸŒ¬ï¸ Wind: {{ weather['wind']['speed'] }} m/s</p>
      </div>
    </div>
    {% endif %}
  </div>

  <div class="footer">
    <p>âœ¨ Designed by <strong>Sayyam Jain</strong> | Powered by OpenWeather</p>
  </div>

  <script>
    // ğŸ• Live Clock
    setInterval(() => {
      const clock = document.getElementById("clock");
      const now = new Date();
      clock.textContent = now.toLocaleTimeString();
    }, 1000);

    // ğŸŒ— Theme Toggle
    const themeSwitch = document.getElementById("themeSwitch");
    themeSwitch.addEventListener("change", () => {
      document.body.classList.toggle("light-mode");
    });

    // ğŸ¤ Voice Input
    const micBtn = document.getElementById("micBtn");
    const cityInput = document.getElementById("cityInput");
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    if (SpeechRecognition) {
      const recognition = new SpeechRecognition();
      recognition.continuous = false;
      recognition.lang = "en-US";

      micBtn.addEventListener("click", () => {
        recognition.start();
        micBtn.textContent = "ğŸ™ï¸ Listening...";
      });

      recognition.onresult = (e) => {
        const transcript = e.results[0][0].transcript;
        cityInput.value = transcript;
        micBtn.textContent = "ğŸ¤";
      };

      recognition.onerror = () => {
        micBtn.textContent = "ğŸ¤";
      };
    } else {
      micBtn.style.display = "none";
    }
  </script>
</body>
</html>